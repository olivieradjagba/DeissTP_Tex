(window["webpackJsonp-pdfverbs-web"]=window["webpackJsonp-pdfverbs-web"]||[]).push([[33],{dkWa:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return s}));var n={Default:"lifecycle.status.storage.importing",OneDrive:"lifecycle.status.onedrive.importing"},s={Default:"lifecycle.status.storage.exporting",OneDrive:"lifecycle.status.onedrive.exporting"}},fkAN:function(e,t,r){"use strict";r.r(t);var n=r("upjz"),s=r.n(n),a=r("DjBF"),c=r.n(a),o=r("prSB"),i=r.n(o),u=r("jQsN"),l=r.n(u),p=r("butC"),d=r.n(p),b=r("2bPg"),f=r.n(b),v=r("BRlI"),x=r.n(v),g=r("+lnk"),h=r("pukD"),m=r("2/nz"),k=function verbToFormat(e){switch(e){case m.f:case m.j:case m.n:case m.t:case m.z:return"pdf";case m.p:return"xlsx";case m.q:return"jpg";case m.r:return"pptx";case m.s:return"docx";default:return"unknown"}},y=r("ip5t"),w=r("3v9k"),_=r("DMWh"),O=r("Ea6J"),E=r("qDLo"),j=r("Jo/A"),F=r("CyNz"),C=r("yqqT"),A=r("DO1T"),J=r("DnId"),T=r("NuY2"),S=r("dkWa"),I=r("Vy9/"),L=function getMessage(e){return Object(I.a)(g.locale2.getLocale()).then((function(t){var r=t[e];return r||e}))},P=function(){function LifecycleBootstrap(){var e=this;f()(this,LifecycleBootstrap),this.ready=d()(l.a.mark((function _callee(){var t;return l.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.providers.dcapi();case 2:return t=r.sent,e.dcapi=t.getDcapi(),r.abrupt("return",e);case 5:case"end":return r.stop()}}),_callee)}))),this.getMaxFileSize=function(){var e=d()(l.a.mark((function _callee2(e,t){var r,n,s;return l.a.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:if(r=0,!e){a.next=17;break}if(!g.auth2.isSignedIn||!t){a.next=11;break}return a.next=5,g.providers.limits2();case 5:return n=a.sent,a.next=8,n.getStaticLimits()[t][e];case 8:r=a.sent,a.next=17;break;case 11:return a.next=13,g.providers.limits();case 13:return s=a.sent,a.next=16,s.getStaticLimits()[e];case 16:r=a.sent;case 17:return void 0===r&&(r=0),a.abrupt("return",1024*Math.max(r,102400));case 19:case"end":return a.stop()}}),_callee2)})));return function(t,r){return e.apply(this,arguments)}}(),this.getExtension=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(e.split(".").slice(1).pop()||"").toLowerCase()},this.isSupportedFileSize=function(e,t){return e>=1&&e<=t},this.isSupportedFileType=function(t,r){var n=e.getExtension(t);return r.includes(n)},this.processChildJob=function(){var e=d()(l.a.mark((function _callee3(e){var t,r,n,s,a,c,o;return l.a.wrap((function _callee3$(u){for(;;)switch(u.prev=u.next){case 0:return t=e.parentJobId,u.next=3,g.providers["lifecycle-progress"]();case 3:if(r=u.sent,n=!0,s=0,!t){u.next=20;break}if(a=r.getJobById(t),a.childJobIds.forEach((function(e){var t=r.getJobById(e),a=t.status,c=t.stage;n=n&&(a===E.a.DONE||a===E.a.UPLOAD_COMPLETE||a===E.a.ERROR),a!==E.a.ERROR&&c!==h.a.ERROR&&(s+=1)})),c={jobId:t},s){u.next=15;break}c=i()(i()({},c),{},{status:E.a.ERROR,stage:h.a.DROPZONE,navConfig:null,progress:0}),u.next=19;break;case 15:if(o=n?E.a.UPLOAD_COMPLETE:E.a.UPLOADING,a.status!==o){u.next=18;break}return u.abrupt("return");case 18:c=i()(i()({},c),{},{status:o});case 19:r.updateJob(c);case 20:case"end":return u.stop()}}),_callee3)})));return function(t){return e.apply(this,arguments)}}(),this.isEligibleForFreeOp=function(){var e=d()(l.a.mark((function _callee4(e){var t,r,n,s,a;return l.a.wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:if(!g.auth2.isSignedIn){c.next=23;break}return c.next=3,g.providers.user();case 3:return t=c.sent,c.next=6,t.isFreeUser();case 6:if(!c.sent){c.next=9;break}return c.abrupt("return",!0);case 9:return c.next=11,t.getLimitsConversions();case 11:return r=c.sent,n=!1,c.next=15,g.discovery.callBootstrapMethod(e,"getLimitNames");case 15:if(c.t0=c.sent,c.t0){c.next=18;break}c.t0={};case 18:return s=c.t0,a=s.process,(void 0===a?[]:a).forEach((function(e){r[e]&&r[e].remaining>0&&(n=!0)})),c.abrupt("return",n);case 23:return c.abrupt("return",!1);case 24:case"end":return c.stop()}}),_callee4)})));return function(t){return e.apply(this,arguments)}}(),this.getVerbLimit=function(){var e=d()(l.a.mark((function _callee5(e){var t;return l.a.wrap((function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.providers.limits2();case 2:return t=r.sent,r.abrupt("return",t.getLimit(e));case 4:case"end":return r.stop()}}),_callee5)})));return function(t){return e.apply(this,arguments)}}(),this.shouldUpsell=function(){var e=d()(l.a.mark((function _callee6(e){var t;return l.a.wrap((function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:if(!g.router.getURLSearchParams().get("showUpsell")){r.next=3;break}return r.abrupt("return",!0);case 3:return r.next=5,g.providers.limits2();case 5:return t=r.sent,r.next=8,t.getLimit(e);case 8:if(-1!==r.sent.remaining){r.next=11;break}return r.abrupt("return",!1);case 11:return r.abrupt("return",!t.canPerform(e));case 12:case"end":return r.stop()}}),_callee6)})));return function(t){return e.apply(this,arguments)}}(),this.getLimitsCookieValue=function(e){var t=document.cookie.match("(^|;) ?".concat(e,"=([^;]*)(;|$)"));return t?t[2]:null},this.decrementLimitsCookiesForFreeUser=function(){var t=d()(l.a.mark((function _callee8(t,r){var n,s,a;return l.a.wrap((function _callee8$(c){for(;;)switch(c.prev=c.next){case 0:if(r!==T.b){c.next=2;break}return c.abrupt("return");case 2:return c.next=4,Object(y.G)();case 4:if(!c.sent){c.next=7;break}return c.abrupt("return");case 7:return c.next=9,t.getLimitNames();case 9:return n=c.sent,s=n.process,c.next=13,t.getCookieNames();case 13:a=c.sent,s.forEach(function(){var t=d()(l.a.mark((function _callee7(t){var r,n,s,c,o,i,u,p,d,b;return l.a.wrap((function _callee7$(l){for(;;)switch(l.prev=l.next){case 0:if(!(r=a[t]||null)){l.next=17;break}return n=r.name,s=r.expiration,l.next=5,Object(y.s)(t);case 5:return c=l.sent,o=Object(y.r)(n),i=null,o?i=1*o:((u=new Date).setTime(u.getTime()+s),i=u.getTime()),l.t0=Math,l.next=12,Object(y.k)(n,c);case 12:l.t1=l.sent,p=l.t0.max.call(l.t0,l.t1,0),d="expires=".concat(new Date(i).toUTCString()),e.os&&e.browser||(b=window.UAParser&&new window.UAParser,e.os=b.getOS(),e.browser=b.getBrowser()),Object(A.h)(e.browser,e.os)?(document.cookie="".concat(n,"-expiration=").concat(i,"; ").concat(d,"; path=/; SameSite=None; secure"),document.cookie="".concat(n,"=").concat(p,"; ").concat(d,"; path=/; SameSite=None; secure")):(document.cookie="".concat(n,"-expiration=").concat(i,"; ").concat(d,"; path=/"),document.cookie="".concat(n,"=").concat(p,"; ").concat(d,"; path=/"));case 17:case"end":return l.stop()}}),_callee7)})));return function(e){return t.apply(this,arguments)}}());case 15:case"end":return c.stop()}}),_callee8)})));return function(e,r){return t.apply(this,arguments)}}(),this.getJobsFromParent=function(){var e=d()(l.a.mark((function _callee9(e){var t,r,n,s;return l.a.wrap((function _callee9$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.providers["lifecycle-progress"]();case 2:return t=a.sent,r=t.getJobById(e),n=[],s=r.childJobIds,(void 0===s?[]:s).forEach((function(e){n.push(t.getJobById(e))})),a.abrupt("return",n);case 8:case"end":return a.stop()}}),_callee9)})));return function(t){return e.apply(this,arguments)}}(),this.getAssetsToExport=function(){var e=d()(l.a.mark((function _callee10(e,t){var r,n,s,a,c,o;return l.a.wrap((function _callee10$(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,g.providers["lifecycle-progress"]();case 2:return r=i.sent,n=r.getJobById(e),a=n.assetForOperation||n.inputAsset,c=a.importedAsset,o=a.origAsset,s=t.multiple_asset_result?t.multiple_asset_result.map((function(e){return{uri:e.uri,importedAsset:c,origAsset:o}})):{uri:t.asset_result.uri,importedAsset:c,origAsset:o},i.abrupt("return",s);case 8:case"end":return i.stop()}}),_callee10)})));return function(t,r){return e.apply(this,arguments)}}(),this.exportConnectorAsset=function(){var t=d()(l.a.mark((function _callee11(t,r){var n,s,a,c,o=arguments;return l.a.wrap((function _callee11$(i){for(;;)switch(i.prev=i.next){case 0:if(n=o.length>2&&void 0!==o[2]?o[2]:"rename",!r){i.next=11;break}return i.next=4,g.providers["storage-connectors"]();case 4:return a=i.sent,i.next=7,e.getAssetsToExport(t,r);case 7:return c=i.sent,i.next=10,a.exportFiles(c,{conflict_behaviour:n});case 10:s=i.sent;case 11:return i.abrupt("return",{exportedAssets:s});case 12:case"end":return i.stop()}}),_callee11)})));return function(e,r){return t.apply(this,arguments)}}(),this.importConnectorAssets=function(){var t=d()(l.a.mark((function _callee13(t,r){var n,s,a,c;return l.a.wrap((function _callee13$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(O.d)(r);case 2:if(n=o.sent,o.t0=n.clickContext,o.t0){o.next=11;break}if(o.t1=n.getClickContext,!o.t1){o.next=10;break}return o.next=9,n.getClickContext();case 9:o.t1=o.sent;case 10:o.t0=o.t1;case 11:return s=o.t0,o.next=14,g.providers["lifecycle-progress"]();case 14:return a=o.sent,o.next=17,Promise.all(t.map(function(){var t=d()(l.a.mark((function _callee12(t){var c,o,u,p,d,b,f,v,x,g,h,m,k;return l.a.wrap((function _callee12$(l){for(;;)switch(l.prev=l.next){case 0:return c=t.assetForOperation,o=t.jobId,u=t.parentJobId,l.next=3,L(S.b[c.connectorType]);case 3:return p=l.sent,u&&a.updateJob({jobId:u,connectorMessage:p}),d=a.updateJob({jobId:o,connectorMessage:p}),f=new w.b(w.a.workflows.acrobat,"LifecycleBootstrap"),v=c.connectorType,x=i()(i()({},Object(w.c)([{size:c.size,type:c.type}])),{},{source:v}),l.prev=9,f.sendEvent(r,w.a.types.job,w.a.subTypes.importing,{source:{click_context:s},content:x}),l.next=13,e.importConnectorAsset(c);case 13:b=l.sent,f.sendEvent(r,w.a.types.job,w.a.subTypes.imported,{source:{click_context:s},content:x}),l.next=24;break;case 17:l.prev=17,l.t0=l.catch(9),g=j.b,l.t0&&"string"==typeof l.t0&&(l.t0.includes(j.e)&&(g=j.j),l.t0.includes(j.l)&&(g=j.c)),h={code:g},m={connectorType:c.connectorType},Object(J.b)(f,r,d,n.translations,h,m);case 24:return k=a.updateJob({jobId:o,assetForOperation:b}),l.abrupt("return",k);case 26:case"end":return l.stop()}}),_callee12,null,[[9,17]])})));return function(e){return t.apply(this,arguments)}}()));case 17:return c=o.sent,o.abrupt("return",c);case 19:case"end":return o.stop()}}),_callee13)})));return function(e,r){return t.apply(this,arguments)}}(),this.importConnectorAsset=function(){var e=d()(l.a.mark((function _callee14(e){var t,r,n,s,a,o;return l.a.wrap((function _callee14$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,g.providers["storage-connectors"]();case 2:return t=u.sent,u.next=5,t.importFiles(e,{showError:!1});case 5:if(r=u.sent,n=c()(r,1),!(s=n[0]).importedAsset||!s.origAsset){u.next=11;break}return a=s.importedAsset,o=s.origAsset,u.abrupt("return",i()({importedAsset:a,origAsset:o,asset_uri:a.uri},a));case 11:return u.abrupt("return",s);case 12:case"end":return u.stop()}}),_callee14)})));return function(t){return e.apply(this,arguments)}}()}var e,t,r,n,a,o,u,p,b,v,I,P,D;return x()(LifecycleBootstrap,[{key:"getJobs",value:(D=d()(l.a.mark((function _callee15(e,t){var r,n,s,a,c,o,u,p,d,b,f,v,x,g,h,m,k,y,w,_=arguments;return l.a.wrap((function _callee15$(l){for(;;)switch(l.prev=l.next){case 0:return r=_.length>2&&void 0!==_[2]?_[2]:{},l.next=3,Object(O.d)(e);case 3:if(n=l.sent,s=n.context,a=t.selectedAssets,c=t.fileObjects,o=t.originalLength,u=r.props,p=void 0===u?{}:u,d=r.neverShowProgress,b=p.focusOnCreate,f=[],v=c.length?c.length:a.length,x=r&&r.context===T.a,g=x&&v<o&&o>1,h=1===v,m=Object(O.e)(r,s),k=!g&&!m&&h,null==b&&(b=k),null==d&&(d=k),y=!r||void 0===r.enableUNCProgressEntry||r.enableUNCProgressEntry,w=i()(i()({},r),{},{props:i()(i()({},p),{},{enableUNCProgressEntry:y,focusOnCreate:b}),neverShowProgress:d}),!c.length){l.next=26;break}return l.next=23,this.createJobsForFileObjects(e,c,w);case 23:f=l.sent,l.next=35;break;case 26:if(!a.some((function(e){return!!e.connectorId}))){l.next=32;break}return l.next=29,this.createJobsForConnectorAssets(e,a,w);case 29:f=l.sent,l.next=35;break;case 32:return l.next=34,this.createJobsForSelectedAssets(e,a,w);case 34:f=l.sent;case 35:return l.abrupt("return",f);case 36:case"end":return l.stop()}}),_callee15,this)}))),function getJobs(e,t){return D.apply(this,arguments)})},{key:"checkForFileTypeSizeError",value:(P=d()(l.a.mark((function _callee16(e,t,r){var n,s,a=this;return l.a.wrap((function _callee16$(c){for(;;)switch(c.prev=c.next){case 0:return n=[],s=[],t.forEach((function(t){a.isSupportedFileSize(t.size,r)&&a.isSupportedFileType(t.name,e)?n.push(t):s.push(t)})),c.abrupt("return",{validAssets:n,invalidAssets:s});case 4:case"end":return c.stop()}}),_callee16)}))),function checkForFileTypeSizeError(e,t,r){return P.apply(this,arguments)})},{key:"getAssets",value:(I=d()(l.a.mark((function _callee17(e){var t,r,n,a,c,o,u,p,d,b,f,v,x,h,m,k,E,j,F,C,A,J,T,S,I,L,P,D,$,U,N,z,R,B,M,G,H,q,V,W,Q,Y,Z,K,X,ee,te,re,ne,se,ae,ce,oe,ie=arguments;return l.a.wrap((function _callee17$(l){for(;;)switch(l.prev=l.next){case 0:return t=ie.length>1&&void 0!==ie[1]?ie[1]:{},l.next=3,Object(O.d)(e);case 3:if(r=l.sent,l.t0=r.clickContext,l.t0){l.next=12;break}if(l.t1=r.getClickContext,!l.t1){l.next=11;break}return l.next=10,r.getClickContext();case 10:l.t1=l.sent;case 11:l.t0=l.t1;case 12:return n=l.t0,a=r.verb,c=r.group,o=r.translations,u=r.getUpsellParams,p=r.supportedFileTypes,d=r.supportedDroppedFileTypes,b=r.allSupportedFileTypes,f=r.getLimitNames,v=t.getAssetsfromSelectionProvider,x=t.targetFormats,h=t.selectionName,m=t.getTooManyFilesMessageId,k=t.getFileSelectionParams,E=new w.b(w.a.workflows.acrobat,e),l.next=18,Object(O.c)(h);case 18:return j=l.sent,F=[],C=[],A=j.rejected||[],J=!1,T=0,S={source:{click_context:n}},Object(O.a)(j)?(F=v&&"function"==typeof v?v(j):j.selectedItems||[],J=!0,T=F.length):(C=j.fileObjects||[],T=C.length),I=F.length?F:C,l.next=29,g.providers["lifecycle-progress"]();case 29:return L=l.sent,l.next=32,this.isEligibleForFreeOp(e);case 32:return P=l.sent,D=I.length+A.length,l.next=36,u();case 36:if($=l.sent,U=$.remainingOps,l.t2=d&&d().acceptDroppedExtensions,l.t2){l.next=43;break}return l.next=42,p();case 42:l.t2=l.sent.acceptExtensions;case 43:if(N=l.t2,l.t4=k,!l.t4){l.next=49;break}return l.next=48,k();case 48:l.t4=l.sent;case 49:if(l.t3=l.t4,l.t3){l.next=52;break}l.t3={};case 52:if(z=l.t3,R=z.singleSelection,!(D>1)||"organizepdf"===c&&g.auth2.isSignedIn||"combinepdf"===c||!R&&!P&&-1===U){l.next=67;break}return L.deFocusJob(),l.next=58,Object(O.b)(o);case 58:return B=l.sent,M=B.getErrObj("TooManyFiles",m(),{},"conv.err.sum.too.many.files",a),B.showErrToast(M.description),L.sendHostEvent(_.h,M),G=I.concat(A),H=Object(w.c)(G),E.sendErrorEvent(e,M,i()(i()({},S),{},{content:H})),j.clearSelection(),l.abrupt("return",{selectedAssets:[],fileObjects:[]});case 67:if(l.t5=f,!l.t5){l.next=72;break}return l.next=71,f();case 71:l.t5=l.sent;case 72:return q=l.t5,V=q&&q.size&&q.size[0],l.next=76,this.getMaxFileSize(V,a);case 76:return W=l.sent,l.next=79,this.checkForFileTypeSizeError(N,I,W);case 79:if(Q=l.sent,Y=Q.validAssets,Z=Q.invalidAssets,!(A=[].concat(s()(A),s()(Z))).length){l.next=103;break}return l.next=86,Object(O.b)(o);case 86:if(K=l.sent,t.allowMultipleJobs||L.deFocusJob(),!g.auth2.isSignedIn||!P||"organizepdf"!==c&&"splitpdf"!==c){l.next=96;break}if(X=A[0],ee={acceptMimeTypes:["application/pdf"],acceptExtensions:["pdf"]},te=b&&b().acceptExtensions,Object(y.B)(ee,X)||!K.isSupportedFileType(X.name,te)){l.next=96;break}return E.sendEvent(e,w.a.types.upsell,w.a.subTypes.shown,S),Object(y.m)(e),l.abrupt("return",{selectedAssets:[],fileObjects:[]});case 96:re=K.getFileSizeTypeErrorInfo(c,A,x,N,W),ne=re.errMsgBodyID,se=re.errMsgParams,ae=re.errorCode,ce=K.getErrObj(ae,ne,se,"conv.err.sum.unsupported.file",a),oe=Object(w.c)(A),E.sendErrorEvent(e,ce,i()(i()({},S),{},{content:oe})),K.showErrToast(ce.description),L.sendHostEvent(_.h,ce),A.length===D&&j.clearSelection();case 103:return F=J?Y:F,C=J?C:Y,l.abrupt("return",{selectedAssets:F,fileObjects:C,originalLength:T});case 106:case"end":return l.stop()}}),_callee17,this)}))),function getAssets(e){return I.apply(this,arguments)})},{key:"createJobsForFileObjects",value:(v=d()(l.a.mark((function _callee20(e,t){var r,n,s,a,c,o,u,p,b,f,v,x,h,m,y=this,_=arguments;return l.a.wrap((function _callee20$(j){for(;;)switch(j.prev=j.next){case 0:return r=_.length>2&&void 0!==_[2]?_[2]:{},n=_.length>3&&void 0!==_[3]?_[3]:"",j.next=4,Object(O.d)(e);case 4:if(s=j.sent,a=s.translations,j.t0=s.clickContext,j.t0){j.next=14;break}if(j.t1=s.getClickContext,!j.t1){j.next=13;break}return j.next=12,s.getClickContext();case 12:j.t1=j.sent;case 13:j.t0=j.t1;case 14:return c=j.t0,o=s.verb,u=s.group,p=new w.b(w.a.workflows.acrobat,e),j.next=19,g.providers.upload2();case 19:return b=j.sent,j.next=22,g.providers["lifecycle-progress"]();case 22:return f=j.sent,v=n&&f.getJobById(n),n&&f.updateJob({jobId:n,status:E.a.UPLOAD_START}),x=Object(w.c)(t),h={click_context:c},v&&!v.oneTimeAnalyticsEmitted&&t.length&&p.sendEvent(e,w.a.types.job,w.a.subTypes.multiFileUploading,{source:h,content:x,verb:{name:o}}),j.next=30,Promise.all(t.map(function(){var t=d()(l.a.mark((function _callee19(t){var s,c,g,m;return l.a.wrap((function _callee19$(_){for(;;)switch(_.prev=_.next){case 0:return s=Object(w.c)([t]),c={source:h,content:s},p.sendEvent(e,w.a.types.job,w.a.subTypes.uploading,c),g=Date.now(),_.next=6,b.upload(t,i()(i()({details:{source_name:"source",target_format:k(o)},verb:o,group:u},r),{},{parentJobId:n}));case 6:return m=_.sent,n&&(v&&v.status)!==E.a.UPLOADING&&f.updateJob({jobId:n,status:E.a.UPLOADING}),m.assetUploadPromise.then((function(t){if(t){var r=Date.now(),s={name:o,upload_duration:r-g};v&&!v.oneTimeAnalyticsEmitted&&(v=f.updateJob({jobId:n,oneTimeAnalyticsEmitted:!0}),p.sendEvent(e,w.a.types.job,w.a.subTypes.multiFileUploaded,{source:h,content:x,verb:{name:o}})),p.sendEvent(e,w.a.types.job,w.a.subTypes.uploaded,{source:c.source,content:c.content,verb:s}),y.processChildJob(m)}})).catch(function(){var t=d()(l.a.mark((function _callee18(t){var r,n,s,i,u;return l.a.wrap((function _callee18$(l){for(;;)switch(l.prev=l.next){case 0:if(r=Date.now(),n={name:o,upload_duration:r-g},s=t&&t.details&&t.details.content&&t.details.content.error||{code:"UploadError"},p.sendErrorEvent(e,s,{source:c.source,content:c.content,verb:n}),!s){l.next=13;break}return l.next=8,Object(O.b)(a);case 8:return i=l.sent,l.next=11,i.getErrorInfo(m,s);case 11:u=l.sent,i.showErrToast(u.message);case 13:y.processChildJob(m);case 14:case"end":return l.stop()}}),_callee18)})));return function(e){return t.apply(this,arguments)}}()),_.abrupt("return",m);case 10:case"end":return _.stop()}}),_callee19)})));return function(e){return t.apply(this,arguments)}}()));case 30:return m=j.sent,j.abrupt("return",m);case 32:case"end":return j.stop()}}),_callee20)}))),function createJobsForFileObjects(e,t){return v.apply(this,arguments)})},{key:"createJobsForIntegrationAssets",value:(b=d()(l.a.mark((function _callee21(e,t){var r,n,s,a=arguments;return l.a.wrap((function _callee21$(c){for(;;)switch(c.prev=c.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},n=a.length>3&&void 0!==a[3]?a[3]:"",s=t.map((function(e){return i()(i()({},e),e.integrationCloudFile)})),c.abrupt("return",this.createJobsForSelectedAssets(e,s,r,n));case 4:case"end":return c.stop()}}),_callee21,this)}))),function createJobsForIntegrationAssets(e,t){return b.apply(this,arguments)})},{key:"createJobsForConnectorAssets",value:(p=d()(l.a.mark((function _callee22(e,t){var r,n,s,a=arguments;return l.a.wrap((function _callee22$(c){for(;;)switch(c.prev=c.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},n=a.length>3&&void 0!==a[3]?a[3]:"",c.next=4,this.createJobsForSelectedAssets(e,t,r,n);case 4:return s=c.sent,c.abrupt("return",this.importConnectorAssets(s,e));case 6:case"end":return c.stop()}}),_callee22,this)}))),function createJobsForConnectorAssets(e,t){return p.apply(this,arguments)})},{key:"createJobsForSelectedAssets",value:(u=d()(l.a.mark((function _callee23(e,t){var r,n,s,a=this,c=arguments;return l.a.wrap((function _callee23$(o){for(;;)switch(o.prev=o.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:{},n=c.length>3&&void 0!==c[3]?c[3]:"",o.next=4,Promise.all(t.map((function(t){return a.createJobForAsset(t,e,r,n)})));case 4:return s=o.sent,o.abrupt("return",s);case 6:case"end":return o.stop()}}),_callee23)}))),function createJobsForSelectedAssets(e,t){return u.apply(this,arguments)})},{key:"createJobForAsset",value:(o=d()(l.a.mark((function _callee24(e,t){var r,n,s,a,c,o,u,p,d,b,f,v,x=arguments;return l.a.wrap((function _callee24$(l){for(;;)switch(l.prev=l.next){case 0:return r=x.length>2&&void 0!==x[2]?x[2]:{},n=x.length>3&&void 0!==x[3]?x[3]:"",l.next=4,g.providers["lifecycle-progress"]();case 4:return s=l.sent,l.next=7,Object(O.d)(t);case 7:return a=l.sent,c=a.verb,o=a.group,u=a.microgroup,p=r.initialStage,d=void 0===p?h.a.IN_PROGRESS:p,f=!n,v=i()({name:e.name,size:e.size,title:e.name,stage:d,status:E.a.DONE,assetForOperation:e,group:o,microgroup:u,syncToStorage:f,verb:c},r),n?(e.integrationCloudFile&&s.updateJob({jobId:n,status:E.a.UPLOAD_START}),b=s.addChildJob(n,v)):b=s.addJob(i()(i()({},v),{},{status:E.a.PROCESSING})),l.abrupt("return",b);case 14:case"end":return l.stop()}}),_callee24)}))),function createJobForAsset(e,t){return o.apply(this,arguments)})},{key:"reportErrorsToLifecycleProgress",value:(a=d()(l.a.mark((function _callee25(e,t,r){var n,s,a,c,o,i,u,p,d,b,f,v,x,h,m,k,y,E=arguments;return l.a.wrap((function _callee25$(l){for(;;)switch(l.prev=l.next){case 0:return n=E.length>3&&void 0!==E[3]?E[3]:{},s=new w.b(w.a.workflows.acrobat,e),l.next=4,Object(O.d)(e);case 4:if(a=l.sent,l.t0=a.clickContext,l.t0){l.next=13;break}if(l.t1=a.getClickContext,!l.t1){l.next=12;break}return l.next=11,a.getClickContext();case 11:l.t1=l.sent;case 12:l.t0=l.t1;case 13:return c=l.t0,o=a.verb,i=a.translations,u=r.processingStartTime,p=r.processingEndTime,d=Object(w.d)(p-u),b={},u&&p&&(b={name:o,conversion_duration:d}),l.next=21,Object(J.a)(r);case 21:return f=l.sent,v=Object(w.c)([f])||{},t.code===j.n&&n.pageCount?v.page_count=Object(w.g)(n.pageCount):t.code===j.h&&n.opCount?v.page_count=Object(w.g)(n.opCount):n&&n.connectorType&&(v.source=n.connectorType),x={source:{click_context:c},verb:b,content:v},s.sendErrorEvent(e,t,x),l.next=28,g.providers["lifecycle-progress"]();case 28:return h=l.sent,m=r.jobId,l.next=32,Object(O.b)(i);case 32:return k=l.sent,l.next=35,k.getErrorInfo(r,t,n);case 35:y=l.sent,h.reportError(m,y),h.sendHostEvent(_.k,{code:y.code,title:y.summary||y.title,description:y.message,verb:o});case 38:case"end":return l.stop()}}),_callee25)}))),function reportErrorsToLifecycleProgress(e,t,r){return a.apply(this,arguments)})},{key:"setCookieUponJobsComplete",value:(n=d()(l.a.mark((function _callee26(e,t,r){var n=this;return l.a.wrap((function _callee26$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.isEligibleForFreeOp(e.id);case 2:s.sent&&t.forEach((function(t){t.then((function(){return n.decrementLimitsCookiesForFreeUser(e,r)})).catch((function(){}))}));case 4:case"end":return s.stop()}}),_callee26,this)}))),function setCookieUponJobsComplete(e,t,r){return n.apply(this,arguments)})},{key:"monitorAndReportJobStatus",value:(r=d()(l.a.mark((function _callee27(e,t){var r,n,s,a,c,o,u=this,p=arguments;return l.a.wrap((function _callee27$(l){for(;;)switch(l.prev=l.next){case 0:return r=p.length>2&&void 0!==p[2]?p[2]:null,l.next=3,Object(O.d)(e);case 3:if(n=l.sent,l.t0=n.clickContext,l.t0){l.next=12;break}if(l.t1=n.getClickContext,!l.t1){l.next=11;break}return l.next=10,n.getClickContext();case 10:l.t1=l.sent;case 11:l.t0=l.t1;case 12:return s=l.t0,a=n.verb,l.next=16,g.providers["lifecycle-progress"]();case 16:c=l.sent,o=t.jobId,t.redirectConversion?c.sendHostEvent(_.j,t):t.fetchStatusPromise.then((function(){var t,n,u,l,p=new w.b(w.a.workflows.acrobat,e),d=c.getJobById(o);if(d.prevStatus!==E.a.CANCELLED){var b=d.processingStartTime,f=Date.now(),v=Object(w.d)(f-b),x={name:a,conversion_duration:v};if(e===y.b){var g,h,m,k=(null===(g=d.assetForOperation)||void 0===g||null===(h=g.inputFile)||void 0===h?void 0:h.size)||0,O=(null===(m=d.assetMetadata)||void 0===m?void 0:m.size)||0,j=0;0!==k&&(j=Math.round(100*(k-O)/k)),x.output_value=j,x.settings_context=d.compressQuality||"medium"}var F={source:{click_context:s},verb:x,content:i()(i()({},r),{},{source:(null===(t=d.assetForOperation)||void 0===t||null===(n=t.origAsset)||void 0===n?void 0:n.connectorType)||(null===(u=d.inputAsset)||void 0===u||null===(l=u.origAsset)||void 0===l?void 0:l.connectorType)})};p.sendEvent(e,w.a.types.job,w.a.subTypes.processed,F),c.sendHostEvent(_.j,d),c.updateJob({jobId:o,processingEndTime:f})}})).catch((function(t){if(!c.getJobById(o).processingEndTime){var r=Date.now(),n=c.updateJob({jobId:o,processingEndTime:r});u.reportErrorsToLifecycleProgress(e,t,n)}}));case 19:case"end":return l.stop()}}),_callee27)}))),function monitorAndReportJobStatus(e,t){return r.apply(this,arguments)})},{key:"getChildJobs",value:(t=d()(l.a.mark((function _callee28(e,t,r){var n,a,c,o,i,u,p,d,b,f,v,x,h,k,E,C,A,J,T,S,I,L,P,D,$,U,N,z=arguments;return l.a.wrap((function _callee28$(l){for(;;)switch(l.prev=l.next){case 0:return n=z.length>3&&void 0!==z[3]?z[3]:{},a=new w.b(w.a.workflows.acrobat,e),c=r.selectedAssets,o=r.fileObjects,i=o.length?o:c,l.next=6,g.providers["lifecycle-progress"]();case 6:return u=l.sent,p=u.getJobById(t),d=p.childJobIds.length,b="combinepdf"===n.group?F.b:F.m,l.next=12,Object(y.s)(b);case 12:if(f=l.sent,v=f-d,!(i.length>v)){l.next=47;break}return l.next=17,Object(O.d)(e);case 17:return x=l.sent,h=x.verb,k=x.translations,l.next=22,Object(O.b)(k);case 22:return E=l.sent,C=E.getErrorInfo,A=E.showErrToast,J=i.slice(v),i=i.slice(0,v),T={code:j.g},S=Object(w.c)(i),a.sendErrorEvent(e,T,{verb:{name:h},content:S}),I={rejected:J},l.next=33,C(p,T,I);case 33:return L=l.sent,P=L.message,D=(D=void 0===P?"":P).replace("{documentsLimit}",f),p.group===m.e&&(D=D.replace("{name}",J[0].name).replace("{number}",J.length)),l.next=40,A(D,{timeout:0});case 40:if($=l.sent,T.description=D,T.verb=e,u.sendHostEvent(_.k,T),u.updateJob({jobId:p.jobId,toasts:[].concat(s()(p.toasts||[]),[$])}),0!==v){l.next=47;break}return l.abrupt("return",[]);case 47:if(U=[e,i,n,t],!o.length){l.next=54;break}return l.next=51,this.createJobsForFileObjects.apply(this,U);case 51:N=l.sent,l.next=69;break;case 54:if(!c.some((function(e){return!!e.connectorId}))){l.next=60;break}return l.next=57,this.createJobsForConnectorAssets.apply(this,U);case 57:N=l.sent,l.next=69;break;case 60:if(!c.some((function(e){return!!e.integrationCloudFile}))){l.next=66;break}return l.next=63,this.createJobsForIntegrationAssets.apply(this,U);case 63:N=l.sent,l.next=69;break;case 66:return l.next=68,this.createJobsForSelectedAssets.apply(this,U);case 68:N=l.sent;case 69:return l.abrupt("return",N);case 70:case"end":return l.stop()}}),_callee28,this)}))),function getChildJobs(e,r,n){return t.apply(this,arguments)})},{key:"isConversionAllowed",value:(e=d()(l.a.mark((function _callee29(e,t){var r,n,s;return l.a.wrap((function _callee29$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(O.d)(e);case 2:return r=a.sent,n=r.getLimitNames,a.next=6,n();case 6:return s=a.sent,a.abrupt("return",Object(C.a)(s,t));case 8:case"end":return a.stop()}}),_callee29)}))),function isConversionAllowed(t,r){return e.apply(this,arguments)})}]),LifecycleBootstrap}();P.getInstance=g.providerUtil.getSingletonFunction(P);t.default=P}}]);
//# sourceMappingURL=private/lifecycle-bootstrap.js.map